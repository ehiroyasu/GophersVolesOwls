---
title: "Relationship between D and K"
author: "Elizabeth Hiroyasu"
date: "May 17, 2017"
output:
  pdf_document: default
  html_document: default
---

```{r, echo=FALSE, warning=FALSE, message=FALSE}
setwd("../GophersVolesOwls")
library(devtools)
library(roxygen2)
load_all("owls")
library(owls)
```

##The relationship between parameter D and Carrying Capacity

We explored the feasibility of using barn owls (_Tyto alba_) as a biocontrol for rodent pest species in an agricultural setting. The use of simple Lotka-Volterra predator-prey models reveals a relationship between the half-saturation constant (D) and carrying capacity (K_prey). The differential equations for the Lotka-Volterra predator-prey model is as follows:
\[\frac{dN}{dt}=rN(1-\frac{N}{K_{prey}})-\frac{k_{max}N}{N+D}P\]
\[\frac{dP}{dt}= 0]

Rescaling the prey equation and conducting parameter reduction we find the following
\[\frac{dN^1}{dt^1}=N^1(1-N^1)-\frac{P^1N^1}{N^1+D^1}\]

Therefore the model has a steady state at (0,0)

#When solving for the equilibrium value of N, we obtain the following solution:
#\[N_{eq}=\frac{(1-D^1) \pm \sqrt{(D^1-1)^2 + 4(P^1-D^1)}}{2}\]

#Parameters

The model requires multiple parameters:
r = growth rate of prey pop (individuals/season). For our purposes we can specify a low, med, and high growth rate of 0.5, 1.0, and 1.5

K_prey = carrying capacity of prey (individuals)

alpha = attack rate of predator (or capture efficiency; the larger alpha is, the more the per capita growth rate of the prey population is depressed by the addition of a single predator) (units=1/season)

h = handling time The amount of time it takes an owl to kill and eat a single vole (1/k_max) (season/individual)

beta= assimilation efficiency (efficiency of turning prey individuals into per capita growth) This number is calculated from field data and represents the fractional value of one vole to an owl producing five chicks.

delta = death rate of predator (#predator/season)

k_max = maximum feeding rate the most gophers an owl can eat in a single time unit (individuals/season). Calculated from empirical data. We have estimates of the amount of biomass required to support a nest of five chicks, we can then take the average size of a prey item and calculate the number of individuals required per season.

D = half saturation constant (1/(alpha*handling time)) The abundance of prey at which the feeding rate is half maximal (individual)

State variables:
N = starting population of prey 
P = starting population of predator


For this model, time is in terms of season (3 months), so each time interval is represented by a season and four seasons are equivalent to one year.

```{r}
#Parameters
#alpha=0.924
#K_prey=750
k_max=655
#h=1/k_max
D=seq(0, 5, by=0.001)#c(50, 70, 100, 250, 500) #where D is specified, however can be calculated as 1/alpha*h
r=c(0.5, 1, 1.5, 2)

#State variables:
N=c(1000, 1000, 1000, 1000, 1000)
P=c(0.2, 0.4, 0.6, 1.0, 2.0)
```

#Equilibrium simulations
Using the quadratic formula, we can calculate the equilibrium densities of the prey population. N1 is the solution to $N_{eq}=\frac{-(D^1-1) + \sqrt{(D^1-1)^2 + 4(P^1-D^1))}}{2}$. N2 is the solution to $N_{eq}=\frac{-(D^1-1) - \sqrt{(D^1-1)^2 + 4(P^1-D^1))}}{2}$

Plotting the relationship between N* and D
```{r, echo=FALSE, fig.align="left", warning=FALSE}
eq.df<-N_eq(P, D)
plot_eq(df=eq.df, P)
```
This suggests that as the predator density increases, the steady state population decreases. Suggesting that predator density can be adjusted to hold the equilibrium prey density to below zero.



